---
interface Props {
  id?: string;
  title: string;
  text: string;
  image: string;
  imageAlt: string;
  eyebrow?: string;
  imagePosition?: 'left' | 'right';
  theme?: 'light' | 'dark';
  background?: 'light' | 'lightgray' | 'dark' | 'primary';
}

const {
  id,
  title,
  text,
  image,
  imageAlt,
  eyebrow,
  imagePosition = 'right',
  theme = 'light',
  background = 'lightgray',
} = Astro.props;
---

<section
  class={`feature-spotlight ${imagePosition === 'left' ? 'image-left' : ''} ${title.includes('AI') ? 'ai-theme' : ''}`}
  id={id}
  data-theme-section={theme}
  data-bg-section={background}
>
  {title.includes('AI') && (
    <div class="ai-bg-container" aria-hidden="true">
      <svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg" class="ai-bg-svg">
        <defs>
          <linearGradient id="wave-grad" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" style="stop-color:#2B74FF;stop-opacity:0.15" />
            <stop offset="25%" style="stop-color:#00C896;stop-opacity:0.12" />
            <stop offset="50%" style="stop-color:#2B74FF;stop-opacity:0.1" />
            <stop offset="75%" style="stop-color:#4A90E2;stop-opacity:0.08" />
            <stop offset="100%" style="stop-color:#2B74FF;stop-opacity:0.05" />
          </linearGradient>
          <linearGradient id="node-grad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#2B74FF;stop-opacity:0.3" />
            <stop offset="100%" style="stop-color:#FFC640;stop-opacity:0.3" />
          </linearGradient>
        </defs>

        <!-- Abstract waves representing open source flow -->
        <path d="M0 300 Q200 200 400 300 T800 300" fill="none" stroke="url(#wave-grad)" stroke-width="2" opacity="0.5"/>
        <path d="M0 350 Q200 280 400 350 T800 350" fill="none" stroke="url(#wave-grad)" stroke-width="2" opacity="0.4"/>
        <path d="M0 400 Q200 360 400 400 T800 400" fill="none" stroke="url(#wave-grad)" stroke-width="2" opacity="0.3"/>

        <!-- Data flow particles -->
        <circle cx="100" cy="300" r="4" fill="#2B74FF" opacity="0.8">
          <animate attributeName="cx" from="100" to="700" dur="8s" repeatCount="indefinite"/>
          <animate attributeName="cy" values="300;280;320;300" dur="4s" repeatCount="indefinite"/>
        </circle>
        <circle cx="200" cy="350" r="3" fill="#00C896" opacity="0.7">
          <animate attributeName="cx" from="200" to="600" dur="10s" repeatCount="indefinite"/>
          <animate attributeName="cy" values="350;330;370;350" dur="5s" repeatCount="indefinite"/>
        </circle>
        <circle cx="150" cy="250" r="5" fill="#FFC640" opacity="0.9">
          <animate attributeName="cx" from="150" to="650" dur="12s" repeatCount="indefinite"/>
          <animate attributeName="cy" values="250;230;270;250" dur="6s" repeatCount="indefinite"/>
        </circle>
        <circle cx="300" cy="380" r="4" fill="#2B74FF" opacity="0.8">
          <animate attributeName="cx" from="300" to="500" dur="6s" repeatCount="indefinite"/>
          <animate attributeName="cy" values="380;360;400;380" dur="3s" repeatCount="indefinite"/>
        </circle>

        <!-- AI nodes -->
        <circle cx="200" cy="250" r="20" fill="url(#node-grad)" opacity="0.6"/>
        <circle cx="400" cy="350" r="30" fill="url(#node-grad)" opacity="0.7"/>
        <circle cx="600" cy="300" r="25" fill="url(#node-grad)" opacity="0.65"/>

        <!-- Connections -->
        <line x1="200" y1="250" x2="400" y2="350" stroke="#2B74FF" stroke-width="2" opacity="0.3"/>
        <line x1="400" y1="350" x2="600" y2="300" stroke="#00C896" stroke-width="2" opacity="0.3"/>

        <!-- Code brackets representing open source -->
        <text x="150" y="200" font-family="monospace" font-size="20" fill="#2B74FF" opacity="0.4">&lt;/&gt;</text>
        <text x="500" y="250" font-family="monospace" font-size="16" fill="#00C896" opacity="0.3">{}</text>
        <text x="350" y="380" font-family="monospace" font-size="18" fill="#FFC640" opacity="0.4">&lt;&gt;</text>

        <!-- Community network dots -->
        <circle cx="120" cy="180" r="2" fill="#2B74FF" opacity="0.5"/>
        <circle cx="280" cy="200" r="2" fill="#00C896" opacity="0.5"/>
        <circle cx="520" cy="220" r="2" fill="#FFC640" opacity="0.5"/>
        <circle cx="680" cy="190" r="2" fill="#2B74FF" opacity="0.5"/>
        <circle cx="250" cy="420" r="2" fill="#00C896" opacity="0.5"/>
        <circle cx="450" cy="410" r="2" fill="#FFC640" opacity="0.5"/>
        <circle cx="650" cy="430" r="2" fill="#2B74FF" opacity="0.5"/>
      </svg>
    </div>
  )}

    <div class="feature-backdrop" aria-hidden="true"></div>
  <div class="container">
    <div class="feature-grid">
      <div class="feature-copy">
        {eyebrow && <p class="feature-eyebrow">{eyebrow}</p>}
        <h2>{title}</h2>
        <p>{text}</p>
      </div>
      {image && (
        <div class="feature-media">
          <img src={image} alt={imageAlt} loading="lazy" />
        </div>
      )}
    </div>
  </div>
</section>

<style>
  .feature-spotlight {
    position: relative;
    padding: clamp(4rem, 10vw, 8rem) 0;
    overflow: hidden;
    min-height: 80vh;
    display: flex;
    align-items: center;
  }

  .ai-bg-container {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 0;
    opacity: 0.4;
  }

  .ai-bg-svg {
    width: 100%;
    height: 100%;
    transform: rotate(-5deg);
    animation: aiFloat 20s ease-in-out infinite;
  }

  @keyframes aiFloat {
    0%, 100% {
      transform: rotate(-5deg) translateY(0);
    }
    50% {
      transform: rotate(-8deg) translateY(-10px);
    }
  }

  
  
  .feature-backdrop {
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at 15% 20%, rgba(255, 198, 64, 0.2), transparent 55%),
      radial-gradient(circle at 85% 15%, rgba(43, 116, 255, 0.16), transparent 55%),
      radial-gradient(circle at 50% 85%, rgba(139, 210, 255, 0.18), transparent 60%);
    pointer-events: none;
    z-index: 0;
  }

  .feature-grid {
    position: relative;
    z-index: 2;
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: clamp(2rem, 6vw, 4rem);
    align-items: center;
  }

  .feature-spotlight.image-left .feature-grid {
    direction: rtl;
  }

  .feature-spotlight.image-left .feature-copy {
    direction: ltr;
  }

  .feature-copy {
    max-width: 580px;
  }

  .feature-copy h2 {
    font-size: clamp(2rem, 4vw, 3rem);
    line-height: 1.15;
    margin-bottom: 1.5rem;
    color: #0d1c3a;
    font-family: 'Manrope', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    font-weight: 700;
  }

  [data-theme-section="dark"] .feature-copy h2 {
    color: rgba(255, 255, 255, 0.92);
  }

  .feature-copy p {
    font-size: clamp(1.05rem, 2vw, 1.3rem);
    line-height: 1.85;
    color: rgba(13, 28, 58, 0.75);
  }

  [data-theme-section="dark"] .feature-copy p {
    color: rgba(255, 255, 255, 0.78);
  }

  .feature-eyebrow {
    text-transform: uppercase;
    letter-spacing: 0.22em;
    font-size: 0.85rem;
    font-weight: 600;
    color: rgba(13, 28, 58, 0.6);
    margin-bottom: 1rem;
  }

  [data-theme-section="dark"] .feature-eyebrow {
    color: rgba(255, 255, 255, 0.6);
  }

  .feature-media {
    position: relative;
    z-index: 3;
  }

  .feature-media::before {
    content: "";
    position: absolute;
    inset: -8%;
    background: linear-gradient(135deg, rgba(43, 116, 255, 0.25), rgba(255, 198, 64, 0.25));
    filter: blur(60px);
    z-index: 0;
  }

  .feature-media {
    position: relative;
    overflow: visible;
    margin: -10% 0 -40% 0;
    z-index: 1;
  }

  .feature-media::before {
    content: "";
    position: absolute;
    inset: -8%;
    background: linear-gradient(135deg, rgba(43, 116, 255, 0.25), rgba(255, 198, 64, 0.25));
    filter: blur(60px);
    z-index: 0;
  }

  .feature-media img {
    position: relative;
    z-index: 1;
    width: 100%;
    height: auto;
    border-radius: 28px;
    box-shadow: none;
  }

  .feature-spotlight:not(.image-left) .feature-media img {
    margin-left: 30%;
  }

  .feature-spotlight.image-left .feature-media img {
    margin-left: 0;
    margin-right: 0;
  }

  @media (max-width: 900px) {
    .feature-grid {
      grid-template-columns: 1fr;
      text-align: center;
    }

    .feature-spotlight.image-left .feature-grid {
      direction: ltr;
    }

    .feature-copy {
      margin-inline: auto;
    }

    .feature-copy h2 {
      font-size: clamp(1.8rem, 7vw, 2.5rem);
    }

    .feature-copy p {
      font-size: 1.05rem;
    }

    .feature-media {
      max-width: 320px;
      margin: 0 auto !important;
      margin-top: 2rem !important;
      margin-bottom: 0 !important;
      overflow: hidden;
    }

    .feature-media img {
      width: 100%;
      height: auto;
      border-radius: 16px;
      display: block;
    }

    .feature-spotlight:not(.image-left) .feature-media img {
      margin-left: 0 !important;
    }

    .feature-spotlight.image-left .feature-media img {
      margin-right: 0 !important;
    }
  }

  @media (max-width: 768px) {
    .feature-spotlight {
      padding: clamp(2rem, 8vw, 4rem) 0;
      min-height: auto;
    }

    .feature-media {
      max-width: 280px;
      margin: 0 auto !important;
      margin-top: 1.5rem !important;
      margin-bottom: 0 !important;
    }

    .feature-media img {
      border-radius: 12px;
    }
  }
</style>
